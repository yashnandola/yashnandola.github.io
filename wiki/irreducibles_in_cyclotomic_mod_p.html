<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="dcterms.date" content="2021-11-04" />
  <title>Number of irreducible factors of cyclotomic polynomials in finite characteristic</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Number of irreducible factors of cyclotomic polynomials in finite characteristic</h1>
</header>
<nav id="TOC" role="doc-toc">
<h3 id="toc-title">Contents</h3>
<ul>
<li><a href="#using-galois-theory">Using Galois theory</a></li>
<li><a href="#using-burnsides-lemma">Using Burnside’s lemma</a></li>
<li><a href="#upper-bound">Upper bound</a>
<ul>
<li><a href="#in-picture">In picture</a></li>
</ul></li>
</ul>
</nav>
<p>In this part, we will try to make calculations and estimates on the number of <a href="cyclic_codes.html">cyclic codes</a> <span class="math inline">\(C \subset \mathbb{F}_q^{n}\)</span> for a given <span class="math inline">\(n\)</span>. This counting problem is the same as finding the number of factors of <span class="math inline">\(x^n-1\)</span> in <span class="math inline">\(\mathbb{F}_q[X]\)</span>.</p>
<p>This calculation also relevant for computing the <a href="dz_for_cyclotomic.html">Dedekind-zeta function for cyclotomic fields</a>. Also see <a href="https://oeis.org/A000374">this OEIS page</a> for some interesting facts and related sequences.</p>
<h1 id="using-galois-theory">Using Galois theory</h1>
<p>For simplicity, we will now assume that <span class="math inline">\(\gcd(n,q)=1\)</span>. Later, we will explain why making such a modification is completely feasible.</p>
<p>Let <span class="math inline">\(\beta\)</span> be a primitive <span class="math inline">\(n\)</span>th root of unity lying the in the algebraic closure of <span class="math inline">\(\mathbb{F}_q\)</span> .We know that in the field <span class="math inline">\(\mathbb{F}_q[\beta]\)</span> the polynomial <span class="math inline">\(x^n-1\)</span> completely splits as follows.</p>
<p><span class="math display">\[\begin{equation}x^n-1 = (x-1) (x-\beta) ( x - \beta^{2}) \dots (x- \beta^{n-1}) .
\end{equation}\]</span></p>
<p>Now for any root <span class="math inline">\(\beta^i\)</span> of <span class="math inline">\(x^n-1\)</span>, what are the conjugates of <span class="math inline">\(\beta^{i}\)</span>? Because we know the structure of the Galois group, we know that the set of conjugates are <span class="math inline">\(\{ \beta^{i}, \beta ^{iq}, \beta^{iq^{2}}, \dots \}\)</span>. This is because the Galois group of a finite field extension is cyclic and generated by the Frobenius isomorphism. Therefore each irreducible factor of <span class="math inline">\(x^n -1\)</span> looks like</p>
<p><span class="math display">\[\begin{equation}
  (x-\beta^{i})(x-\beta^{iq})(x-\beta^{iq^{2}})\dots
\end{equation}\]</span></p>
<p>for some <span class="math inline">\(i\)</span>.</p>
<p>Inspired by this, let consider the cyclic group of <span class="math inline">\(n\)</span> elements <span class="math inline">\(\mathbb{Z}/n\mathbb{Z}\)</span>, written additively. Let <span class="math inline">\(m_q :\mathbb{Z}/n\mathbb{Z} \rightarrow \mathbb{Z}/n\mathbb{Z}\)</span> be the “multiplication by <span class="math inline">\(q\)</span>” map. Since <span class="math inline">\(\gcd(n,q)=1\)</span>, we know that this multiplication map is a permutation. More importantly, number of cycles of this permutation are in bijection with the irreducible factors of <span class="math inline">\(x^n-1\)</span>.</p>
<p>Now for for any <span class="math inline">\(i \in \mathbb{Z}/n\mathbb{Z}\)</span>, <span class="math inline">\(\gcd(i,n) = \gcd(iq,n)\)</span> . So if we write <span class="math display">\[\mathbb{Z}/n\mathbb{Z} = \bigsqcup_{d| n} \{ k \in \mathbb{Z}/n\mathbb{Z} \ | \ \gcd(k,n)= d \}, \]</span> then <span class="math inline">\(m_q\)</span> permutes the elements of each of those disjoint sets. Let us denote each of those disjoint sets as <span class="math display">\[\begin{equation}V_d  = \{  k \in \mathbb{Z}/n\mathbb{Z} \ | \ \gcd(k,n) = d \}.\end{equation}\]</span> Clearly, <span class="math inline">\(|V_d| = \varphi(n/d)\)</span>, <span class="math inline">\(\varphi\)</span> being the Euler phi function. As an <span class="math inline">\(\langle m_q\rangle\)</span>-set, the action of <span class="math inline">\(m_q\)</span> on <span class="math inline">\(V_d\)</span> is isomorphic to the action of <span class="math inline">\(m_q\)</span> on <span class="math inline">\(\left(\mathbb{Z}/(n/d)\mathbb{Z}\right)^{*}\)</span>. Hence the number of cycles of the action of <span class="math inline">\(m_q\)</span> on <span class="math inline">\(V_d\)</span> as a permutation is equal to the number of cosets of <span class="math inline">\(\langle m_q \rangle \subset \left( \mathbb{Z} / (n/d)\mathbb{Z} \right) ^{*}\)</span> which is equal to <span class="math inline">\({\varphi(\frac{n}{d})}/{ \mathop{\mathrm{ord}}_{\frac{n}{d}}(q ) }\)</span>, where <span class="math inline">\(\mathop{\mathrm{ord}}_{\frac{n}{d}}(q)\)</span> is the order of <span class="math inline">\(q\)</span> as an element of the multiplicative group <span class="math inline">\(\left( {\mathbb{Z}}/{\left( n/d \right) \mathbb{Z} } \right)^*\)</span>.</p>
<h1 id="using-burnsides-lemma">Using Burnside’s lemma</h1>
<p>With the above discussion, we state the following lemma.</p>
<div class="proposition">
<p>When <span class="math inline">\(\gcd(n,q) = 1\)</span> , the number of irreducible polynomials that <span class="math inline">\(x^n-1\)</span> splits in the ring <span class="math inline">\(\mathbb{F}_q[x]\)</span> is given by <span class="math display">\[\begin{equation}
    \psi_q(n) := \sum_{d | n}^{} \frac{\varphi(d)}{\mathop{\mathrm{ord}}_{d}(q)} . 
  \end{equation}\]</span> Alternatively, we can also write <span class="math display">\[\begin{equation}\psi_q(n) = \frac{1}{\mathop{\mathrm{ord}}_n(q)} \sum_{j = 1}^{ \mathop{\mathrm{ord}}_{n}(q) } \gcd(q^j-1,n).  \end{equation}\]</span> </p>
</div>
<div class="proof">
<p>The first equation is clear from the discussion before stating the proposition.</p>
<p>The second formula is an outcome of the Burnside’s lemma on the action of the group generated by <span class="math inline">\(m_q:{\mathbb{Z}}/{n\mathbb{Z}} \rightarrow {\mathbb{Z}}/{ n \mathbb{Z}}\)</span> as a subgroup of the symmetric group <span class="math inline">\(S_n\)</span>.</p>
<p>Let <span class="math inline">\(G = \langle m_q \rangle\)</span> be this group acting on <span class="math inline">\(\mathbb{Z}/n\mathbb{Z}\)</span>. The size of the group is undoubtedly <span class="math inline">\(\text{ord}_n(q)\)</span>. How many elements are fixed by the element <span class="math inline">\(m_q^j\)</span> for some <span class="math inline">\(j\)</span>? That would be the elements of the set <span class="math inline">\(\{ j \in {\mathbb{Z}}/{n\mathbb{Z}}\ | \ jq^j \equiv_n j \}= \{ j \in {\mathbb{Z}}/{n\mathbb{Z}} \ | \ j(q^j-1) \equiv_n 0\}= \ker(m_{q^j-1})\)</span>. There are exactly <span class="math inline">\(\gcd(q^j - 1,n)\)</span> elements in the kernel of the multiplication map <span class="math inline">\(m_{q^j - 1} : {\mathbb{Z}}/{ n \mathbb{Z}} \rightarrow {\mathbb{Z}}/{ n \mathbb{Z}}\)</span>.</p>
<p>Therefore, by picking up the formula of the Cauchy-Frobenius lemma, we get that the number of orbits is</p>
<p><span class="math display">\[  \frac{1}{ |G|} \sum_{g \in G}^{ }| (\mathbb{Z}/n\mathbb{Z})^{g} |  = \frac{1}{\text{ord}_n(q)} \sum_{j=0}^{\text{ord}_n(q) - 1} \gcd(q^j-1,n). \]</span></p>
</div>
<div class="remark">
<p>The second formula provides computationally a much faster way to calculate <span class="math inline">\(\psi_q(n)\)</span> when the prime factorization of <span class="math inline">\(n\)</span> is not known, as compared to the first formula which will require a prime-factorization.</p>
<p>On the other hand, the first formula is more useful for finding an upper bound, as we will see.</p>
</div>
<div class="remark">
<p>If <span class="math inline">\(\gcd(n,q) \neq 1\)</span>, then the following happens. Let <span class="math inline">\(q = p^{r}\)</span> and <span class="math inline">\(\gcd(n,q)= p^{s}\)</span> for some <span class="math inline">\(r,s \in \mathbb{N}^{&gt; 0 }\)</span>. In this case <span class="math inline">\(x^{n} - 1 = (x^{\frac{n}{p^{s}} }-1)^{p^{s}}\)</span> and now <span class="math inline">\(\gcd(n/p^{s}, q) = 1\)</span>. Therefore, the number of factors is now <span class="math inline">\(\psi_q( n /p^{s})p^{s} = \psi_q(n / \gcd(n,q)) \gcd(n,q)\)</span>.</p>
</div>
<h1 id="upper-bound">Upper bound</h1>
<p>The next proposition is aimed to give an upper bound on <span class="math inline">\(\psi_q(n)\)</span> as defined in the above lemma.</p>
<div class="theorem">
<p>If <span class="math inline">\(\psi_q(n)\)</span> is as defined in the Proposition , then for any <span class="math inline">\(C&gt;1\)</span>, eventually for large enough values of <span class="math inline">\(n\)</span> <span class="math display">\[\begin{equation}\psi_q(n)  &lt; C \frac{n}{\log_qn}.\end{equation}\]</span> </p>
</div>
<div class="proof">
<p>From the preceding discussion, we already have that <span class="math display">\[\begin{equation}
    \psi_q(n) = \sum_{d | n}^{} \frac{\varphi(d)}{\text{ord}_{d}(q)} . 
  \end{equation}\]</span> Now note that for any <span class="math inline">\(d\)</span>, <span class="math inline">\(\text{ord}_d(q)\)</span> is the smallest exponent <span class="math inline">\(n\)</span> of <span class="math inline">\(q\)</span> such that <span class="math inline">\(q^n \equiv_d 1\)</span>. Therefore when <span class="math inline">\(d \neq 1\)</span>, as a natural number <span class="math inline">\(q^n = 1\)</span> or <span class="math inline">\(q^n &gt; d\)</span>, and since <span class="math inline">\(q&gt;1\)</span>, only the latter is possible. Therefore <span class="math inline">\(\text{ord}_d(q) &gt; \log_qd\)</span> and therefore <span class="math display">\[\begin{equation}
    \psi_q(n) = \sum_{d | n}^{} \frac{\varphi(d)}{\text{ord}_{d}(q)} \le  1+ \sum_{d | n, d \neq 1}^{} \frac{\varphi(d)}{\log_qd}.
  \end{equation}\]</span> Let <span class="math inline">\(\tau(n)\)</span> be the number of divisors of <span class="math inline">\(n\)</span>. It is a classically known result that for any <span class="math inline">\(\varepsilon &gt; 0\)</span>, <span class="math inline">\(\lim_{n \rightarrow \infty } \frac{\tau(n)}{ n^{\varepsilon}} = 0\)</span>. With that in mind, let <span class="math inline">\(g(n):= \frac{n }{ \tau(n) (\log _q n )^{2}}\)</span> and divide the sum as <span class="math display">\[\begin{equation}
    \sum_{d | n, d\neq 1}^{} \frac{\varphi(d)}{\log_q d} = \sum_{\substack{d | n , d \neq 1 \\ d\le g( n) }}^{} \frac{\varphi(d)}{\log_q d} +
\sum_{\substack{d | n , d \neq 1 \\ d &gt; g( n) }}^{} \frac{\varphi(d)}{\log_q d} . 
  \end{equation}\]</span> For the first term, note that <span class="math inline">\(\varphi(d) \le d\)</span> and therefore <span class="math display">\[\begin{equation}
    \sum_{\substack{ d | n , d\neq 1 \\ d \le  g(n) }}^{} \frac{\varphi(d)}{ \log_q d} \le \sum_{\substack{ d | n, d \neq 1 \\ d \le g(n)}}^{}   { \varphi(d) } \le \tau(n) \left( \frac{ n}{ \tau(n) \left( \log_q n \right) ^{2}} \right) = \frac{n}{\left( log_q n \right)^{2}}.
  \end{equation}\]</span> Now for the large divisors, we have that <span class="math inline">\(d &gt; \frac{n}{\tau(n) \left( \log_q n \right) ^{2}} \Rightarrow \log_qd &gt; \log_qn - \log_q \tau(n) - 2 \log_q \log_q n\)</span>. Therefore <span class="math inline">\(\log_qd &gt; (1+o(1)) \log_q n\)</span> and therefore <span class="math display">\[\begin{equation}
    \sum_{\substack{ d | n , d\neq 1 \\ d &gt;  g(n) }}^{} \frac{\varphi(d)}{ \log_q d} \le \sum_{\substack{ d | n, d \neq 1 \\ d &gt; g(n)}}^{}   \frac{ \varphi(d) }{(1+o(1)) \log_q n} \le \frac{(1+o(1)) }{\log_q n} \sum_{d | n }^{} \varphi(d) =    (1+o(1)) \frac{n}{\log_q n} .
  \end{equation}\]</span> Since the second term will dominate, we have our result.</p>
</div>
<h2 id="in-picture">In picture</h2>
<p>For <span class="math inline">\(q=2\)</span>, a comparison of the result with some empirical data is done in the figure below.</p>
<p><img src="https://nihargargava.com/wiki/images/asymptotsfor2.png" style="width: 100%; align: center;" /></p>
<hr />
	<small>	<p class="date">This page was updated on November 4, 2021.<br>
		<a href="index.html">Main Page</a> </p>
      </small>
</body>
</html>
